Logger.info "=========== Writing <%= @ticket_count %> tickets for #{listing.id} ==========="
Enum.each(1..<%= @ticket_count %>, fn(x) ->
  %TicketAgent.Ticket{
    listing_id: listing.id,
    slug: Random.generate_slug(),
    name: "Ticket for <%= String.replace(@title, "\"", "'") %>",
    status: "available",
    description: "Ticket for <%= String.replace(@title, "\"", "'") %>",
    price: <%= round(@price) * 100 %>,
    sale_start:  NaiveDateTime.from_iso8601!("<%= @created_at %>")
  }
  |> TicketAgent.Repo.insert!
  Logger.info "=========== Inserted ticket ##{x} for #{listing.id} ==========="
end)
Logger.info "=========== Inserted 80 tickets for #{listing.id} ==========="
